/*
Author:     Niklas Heer, Chris Wiegman
Project:    Better Google Tasks
License:    GPL v3
Build date: 06.04.2014 
*/
(function(){var a;a=function(){var a,b;b="https://mail.google.com/tasks/ig?listid=",a="https://mail.google.com/tasks/m",$.ajax({type:"GET",url:a,async:!1,data:null,dataType:"html",success:function(a){var c,d,e,f,g,h,i,j,k,l,m,n,o,p,q;for(i=[],j=[],m=void 0,o=void 0,n=void 0,c=void 0,d=void 0,f=void 0,p=new Date,q=p.getFullYear(),k=p.getMonth()+1,e=p.getDate(),l="<h1>Task list printed "+k+"/"+e+"/"+q+"</h1>",l+="<ul>",n=a,o=n.length,m=n.indexOf("<option value="),f=0;o>0&&m>-1;){if(n=n.substr(m+15,o),o=n.length,c=n.substr(0,n.indexOf('"')),n=n.substr(n.indexOf(">")+1,o),d=n.substr(0,n.indexOf("</option>")),o=n.length,m=n.indexOf("<option value="),i.length>0)for(g=0;g<i.length;)i[g]===c&&(c=-1),g++;else i[f]=c,j[f]=d;-1!==c&&(i[f]=c,j[f]=d),f++}for(h=0;h<i.length;)l+='<li class="list">',l=l+"<h2>"+j[h]+"</h2>",l+="<ul>",$.ajax({type:"GET",url:b+i[h],async:!1,data:null,dataType:"html",success:function(a){var b,c;a.match(/_setup\((.*)\)\}/)&&(b=JSON.parse(RegExp.$1),c=!1,$.each(b.t.tasks,function(a,b){var d,e,f,g;b.name.length>0&&(c?(l+='<li class="task">',c=!1):(l+='<li class="task even">',c=!0),b.completed&&(l+="<s>"),l=l+"<h3>"+b.name+"</h3>",b.task_date&&(g=new Array("January","February","March","April","May","June","July","August","September","October","November","December"),f=b.task_date.substr(0,4),e=b.task_date.substr(4,2)-1,d=b.task_date.substr(6,2),l=l+'<span class="due">Due: '+g[e]+" "+d+", "+f+"</span>"),b.notes&&(l=l+'<span class="notes">'+b.notes+"</span>"),b.completed&&(l+="</s>"),l+="</li>")}))}}),l+="</ul>",l+="</li>",h++;l+="</ul>",document.write(l)}})},$(document).ready(function(){$("body").append(a())})}).call(this);