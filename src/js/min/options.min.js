/*
Author:     Niklas Heer, Chris Wiegman
Project:    Better Google Tasks
License:    GPL v3
Build date: 06.04.2014 
*/
(function(){window.loadOptions=function(){var a,b,c,d,e,f,g,h,i,j,k,l,m,n;for(n=chrome.extension.getBackgroundPage().taskLists,h=localStorage.getItem("com.bit51.chrome.bettergoogletasks.hide_zero")||TASKS_ZERO,c=localStorage.getItem("com.bit51.chrome.bettergoogletasks.default_count")||TASKS_COUNT,b=localStorage.getItem("com.bit51.chrome.bettergoogletasks.countinterval")||TASKS_COUNTINTERVAL,a=localStorage.getItem("com.bit51.chrome.bettergoogletasks.count_list")||TASKS_LIST,f=localStorage.getItem("com.bit51.chrome.bettergoogletasks.default_pop")||TASKS_POPUP,g=localStorage.getItem("com.bit51.chrome.bettergoogletasks.default_width")||TASKS_WIDTH,d=localStorage.getItem("com.bit51.chrome.bettergoogletasks.default_height")||TASKS_HEIGHT,l=localStorage.getItem("com.bit51.chrome.bettergoogletasks.notify")||TASKS_NOTIFY,m=localStorage.getItem("com.bit51.chrome.bettergoogletasks.openbehavior")||TASKS_OPENBEHAVIOR,e=localStorage.getItem("com.bit51.chrome.bettergoogletasks.default_list")||TASKS_DEFAULT_LIST,$("input[name=hide_zero]").val([h]),$("input[name=default_count]").val([c]),$("input[name=count_list]").val([a]),$("input[name=default_pop]").val([f]),$("input[name=countinterval]").val(b),$("input[name=default_width]").val(g),$("input[name=default_height]").val(d),$("input[name=notify]").val([l]),$("input[name=openbehavior]").val([m]),i=0;i<n.length;)j=document.getElementById("lists"),k=!1,n[i].id===e&&(k=!0),j.add(new Option(n[i].title,n[i].id,k),null),i++;setSelectByValue("opform","default_list",e)},window.saveOptions=function(){var a,b,c,d,e,f,g,h,i,j,k;c=$("input[name=default_count]:checked").val()||TASKS_COUNT,h=$("input[name=hide_zero]:checked").val()||TASKS_ZERO,f=$("input[name=default_pop]:checked").val()||TASKS_POPUP,a=$("input[name=count_list]:checked").val()||TASKS_LIST,b=$("input[name=countinterval]").val()||TASKS_COUNTINTERVAL,e=$("select[name=default_list]").val()||TASKS_DEFAULT_LIST,g=$("input[name=default_width]").val()||TASKS_WIDTH,d=$("input[name=default_height]").val()||TASKS_HEIGHT,i=$("input[name=notify]:checked").val()||TASKS_NOTIFY,j=$("input[name=openbehavior]:checked").val()||TASKS_OPENBEHAVIOR,localStorage.setItem("com.bit51.chrome.bettergoogletasks.default_count",c),localStorage.setItem("com.bit51.chrome.bettergoogletasks.hide_zero",h),localStorage.setItem("com.bit51.chrome.bettergoogletasks.default_list",e),localStorage.setItem("com.bit51.chrome.bettergoogletasks.countinterval",b),localStorage.setItem("com.bit51.chrome.bettergoogletasks.default_pop",f),localStorage.setItem("com.bit51.chrome.bettergoogletasks.count_list",a),localStorage.setItem("com.bit51.chrome.bettergoogletasks.default_width",g),localStorage.setItem("com.bit51.chrome.bettergoogletasks.default_height",d),localStorage.setItem("com.bit51.chrome.bettergoogletasks.notify",i),localStorage.setItem("com.bit51.chrome.bettergoogletasks.openbehavior",j),k=chrome.extension.connect({name:"BGT"}),k.postMessage({message:"Update"}),$("div#saved").fadeIn("slow").delay(500).fadeOut("slow")},window.setSelectByValue=function(a,b,c){var d,e,f;if(d=document.forms[a].elements[b],f=!1,"select-one"===d.type){for(e=0;e<d.options.length&&d.options[e].value!==c;)e++;(f=e!==d.options.length)&&(d.selectedIndex=e)}return f},window.resetOptions=function(){var a;localStorage.removeItem("com.bit51.chrome.bettergoogletasks.default_count"),localStorage.removeItem("com.bit51.chrome.bettergoogletasks.hide_zero"),localStorage.removeItem("com.bit51.chrome.bettergoogletasks.default_list"),localStorage.removeItem("com.bit51.chrome.bettergoogletasks.countinterval"),localStorage.removeItem("com.bit51.chrome.bettergoogletasks.default_pop"),localStorage.removeItem("com.bit51.chrome.bettergoogletasks.count_list"),localStorage.removeItem("com.bit51.chrome.bettergoogletasks.default_width"),localStorage.removeItem("com.bit51.chrome.bettergoogletasks.default_height"),localStorage.removeItem("com.bit51.chrome.bettergoogletasks.notify"),localStorage.removeItem("com.bit51.chrome.bettergoogletasks.notifyExp"),localStorage.removeItem("com.bit51.chrome.bettergoogletasks.openbehavior"),a=chrome.extension.connect({name:"BGT"}),a.postMessage({message:"Update"}),window.close()},$(document).ready(function(){loadOptions(),$("#extVersion").prepend(localStorage.getItem("com.bit51.chrome.bettergoogletasks.version")),$("#saveOptions").click(function(){saveOptions()}),$("#resetOptions").click(function(){resetOptions()})})}).call(this);